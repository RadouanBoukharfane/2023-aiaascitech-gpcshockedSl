\documentclass[conf]{new-aiaa}


\usepackage{graphicx}
\usepackage{amsmath}
\usepackage[version=4]{mhchem}
\usepackage{siunitx}
\usepackage{longtable,tabularx}
\usepackage{bm}
\usepackage{scalerel}
\usepackage{tikz,pgfplots,pgfplotstable}
\usepackage{subcaption}
\usepackage{overpic}
\usepackage{mathtools}

\DeclarePairedDelimiter\autobracket{(}{)}
\linespread{1.4}


\DeclareMathAlphabet{\mathesstixfrak}{U}{esstixfrak}{m}{n}
\DeclareMathAlphabet{\mathboondoxfrak}{U}{BOONDOX-frak}{m}{n}
\newcommand{\ie}{\emph{i.e~}}
\renewcommand{\th}{\textsuperscript{th}~}
\DeclareMathOperator{\Nabla}{\mathbf{\nabla}}
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} %To use HRule command
\newcommand*{\acro}[1]{\textsc{\MakeLowercase{#1}}} % acronyms etc.
\newcommand*{\unit}[1]{\ensuremath{\,\mathrm{#1}}}
\newcommand*{\pd}[3][]{\frac{\partial^{#1}#2}{\partial{#3}^{#1}}} % partial derivative
\newcommand*{\reyno}[1]{\bar{#1}}
\newcommand*{\favre}[1]{\widetilde{#1}}
\newcommand{\ud}{\mathrm{d}} % normal derivative
\newcommand{\mywidtha}{0.42\textwidth}
\newcommand{\mywidthb}{0.41\textwidth}
\newcommand{\mywidthc}{0.44\textwidth}
\newcommand{\mywidthd}{0.37\textwidth}
\newcommand{\mywidthtwoa}{0.368\textwidth}
\newcommand{\mywidthbanormal}{0.39\textwidth}
\newcommand{\mywidthdanormal}{0.36\textwidth}
\newcommand{\uD}{\mathrm{D}}
\newcommand*{\dwz}{\delta_{\omega,0}}
\newcommand*{\dw}{\delta_{\omega}}
\newcommand{\pars}[1]{\left(\,{#1}\,\right)}
\newcommand*{\uunit}[1]{\ensuremath{\mathrm{#1}}}
\newcommand*{\ex}[1]{\times 10^{#1}}%shorthand -- for use in tables
\newcommand{\adinf}[1]{{#1}_{\mathrm{\infty}}} % infinity
\newcommand{\adinfb}[1]{{#1}^*_{\mathrm{\infty}}} % infinity b
\newcommand{\adref}[1]{{#1}_{\mathrm{ref}}} % reference
\newcommand{\adrefb}[1]{{#1}^*_{\mathrm{ref}}} % reference b
\newcommand{\adndim}[1]{{#1}^*} % non-dimensioned
\newcommand{\addim}[1]{{#1}} % dimensioned
\newcommand{\Wcal}{\mathcal{W}}
\newcommand{\Rcal}{\mathcal{R}}
\newcommand{\nspc}{\mathcal{N}_{sp}}
\newcommand{\w}{\mathcal{W}}
\newcommand{\ro}[1]{\mathrm{#1}}
%=============================================================
\title{A gPC-based approach to uncertain interaction of oblique shocks and supersonic mixing layers}
%=============================================================
\setlength\LTleft{0pt} 
%=============================================================
\author{
S. Baaziz
\footnote{Graduate Student, sarah.baaziz@um6p.ma}}
\affil{University of Lille, Lille Fluid Mechanics Laboratory, France}
\author{R. Boukharfane
\footnote{Research \& Education fellow, radouan.boukharfane@um6p.ma, AIAA Member}}
\affil{Mohammed VI Polytechnic University (UM6P), MSDA group, Benguerir, Morocco}
\begin{document}
%=============================================================
\date\today
%=============================================================
\maketitle
%=============================================================
\begin{abstract}
The present paper focus on the stochastic response of a three-dimensional shock wave impingement on a spatially evolving mixing layer to parametric uncertainties.
%
Both the oblique shock angle and the convective Mach number are considered as random parameters and the generalized Polynomial Chaos (gPC) theory is coupled with standard deterministic numerical simulations through a spectral collocation projection methodology.
%
The results allow for a better understanding of the flow sensitivity to such uncertainties and underline the coupling process between the stochastic parameters.
%
Some results of direct numerical simulations of the multicomponent, compressible, reactive Navier-Stokes equations are reported here for the particular case of a two-dimensional mixing layer. Special emphasis is placed on the effects associated with heat release.
\end{abstract}
%=============================================================
\section{Introduction}
%=============================================================
%
The validation and verification of computational fluid dynamics (CFD) tools using wind tunnel experimental results poses many questions on the way to setup the test case and on the necessary test data to use in the numerical configuration to make the numerical simulation most compatible to the real flow \cite{szoke2020developing}.
%
In this process the account of real information on the flow generated by the wind tunnel appears as an important matter often neglected in the simulation work.
%
In fact a wind tunnel represents a complex system that generates testing conditions not necessarily well-known \cite{cattafesta2010fundamentals}.
%
This leads to an intrinsic uncertainty in the proper setting and initialisation of the numerical model to target experimental reproduction that, on general grounds, includes geometrical and flow parameters alike.
%
In this work, the system of interest is the interactions of shocks with shear flows which occur in many high-speed flow situations such as external aerodynamics of transonic, supersonic and hypersonic flow, internal flows in scramjets \cite{chakravarthy2018analytical,karthick2021shock}.
%
Shock interactions with free shear and wall-bounded flows have been shown to impact mixing, increase losses and affect surface drag and/or heat transfer depending upon the strength of the shock. 
%
Uncertainty quantification of the influence of uncertain parameters onto mixing efficiency obtained from shock/shear interactions is a major issue in order to properly predict the system response to random inputs.
%
Several benefits can be gained from such studies.
%
For example, it permits to i) take into consideration realistic safety margins depending on the solution sensitivity to the random inputs, and ii) to study the coupling process between several uncertain parameters, which can not be investigated through linearized approaches like Adjoint-state-based methods \cite{mittal2016flexible}.
%
Moreover, uncertainty quantification leads to a classification of the most influential parameters on the system response and allows for the identification of extreme behaviors under specific coupling.
%
Moreover, uncertainty quantification leads to a classification of the most influential parameters on the system response.
%
A better understanding of the related phenomena is thus required for applications such as scramjet engines, the efficiency of which depends crucially on a proper mixing of oxidizer and fuel.
%
In the present study,  the effects of a randon oblique shock angle and convective Mach number on the mean flow are examined. The influence of the turbulent structures on the global interaction is then identified, and the mixing enhancement is assessed.
%
The analysis is conducted in the light of DNS results.
%=============================================================
\section{Description of the numerical solver}
%=============================================================
The unsteady, three-dimensional, compressible Navier-Stokes equations are considered for a multi-species reactive gas mixture:
\begin{equation}\label{eq:eqs_originelles_ch_i}
\pd{\addim{\rho}}{\addim{t}}+
\pd{\addim{\rho} \addim{u}_j}{\addim{x}_j}=0 ,
\end{equation}
\begin{equation}
\pd{\addim{\rho} \addim{u}_i}{\addim{t}}+
\pd{\addim{\rho} \addim{u}_i \addim{u}_j}{\addim{x}_j}
+\pd{\addim{p}}{\addim{x}_i}=\pd{\addim{\tau}_{ij}}{\addim{x}_j} , \quad
i \in \left[ 1,3 \right] ,
\end{equation}
\begin{equation}
\pd{\addim{\rho} \addim{e}_t}{\addim{t}}+
\pd{\left(\addim{\rho} \addim{e}_t + \addim{p} \right)\addim{u}_j}
{\addim{x}_j}=
\pd{\addim{u}_j\addim{\tau}_{ij}}{\addim{x}_j}
-\pd{\addim{q}_j}{\addim{x}_j} , \label{eq:energie_ch}
\end{equation}
\begin{equation}
\pd{\addim{\rho}Y_\alpha}{\addim{t}}+
\pd{\addim{\rho} Y_\alpha \addim{u}_j}{\addim{x}_j}=
-\pd{\addim{\rho} Y_\alpha \addim{V}_{\alpha j}}{\addim{x}_j} +
\addim{\rho} \addim{\dot{\omega}}_\alpha , \quad
\alpha \in \left[ 1,\nspc \right] ,
\label{eq:eqs_originelles_ch_f}
\end{equation}
where $\addim{\tau}_{ij}=2\addim{\mu}\left(\addim{S}_{ij} - \delta_{ij} \addim{S}_{kk} / 3 \right)$ and $\addim{S}_{ij}=\left(\partial{\addim{u}_i}/\partial{\addim{x}_j}+
\partial{\addim{u}_j}/\partial{\addim{x}_i}\right)/2$. $\addim{\rho}\addim{e}_t=\addim{\rho}{\addim{u}_i\addim{u}_i}/{2}+ \addim{\rho}\sum^{\nspc}_{\alpha=1} \addim{h}_\alpha Y_\alpha - \addim{p}$ and $\addim{h}_\alpha \left(\addim{T}_1\right) =  \Delta {\addim{h}}^0_{f\alpha} + \int^{\addim{T}_1}_{\addim{T}_0}  \addim{c}_{p\alpha} \left(\addim{T}\right) \mathrm{d} \addim{T}$. The pressure of the mixture is given by $\addim{p}=\addim{\rho}{\Rcal}\addim{T}/{\Wcal}$, with $\Wcal^{-1}=\sum^{\nspc}_{\alpha=1} {Y_\alpha}/{\Wcal_\alpha}$. $\addim{q}_j=-\addim{\lambda} \partial{\addim{T}}/\partial{\addim{x}_j} + \addim{\rho} \sum^{\nspc}_{\alpha=1}  \addim{h}_\alpha Y_\alpha \addim{V}_{\alpha j} $ and $Y_{\alpha}\addim{V}_{\alpha j} = Y_{\alpha}   \sum^{\nspc}_{\beta=1} \addim{D}_{\beta} ({\Wcal_{\beta}}/{\Wcal}) \partial{X_{\beta}}/\partial{\addim{x}_j} - \addim{D}_{\alpha} ({\Wcal_{\alpha}}/{\Wcal}) \partial{X_{\alpha}}/\partial{\addim{x}_j} $.
%
This system of conservative equations is based on the following set of independent variables: the density $\addim{\rho}$, the momentum $\addim{\rho} \addim{u}_i$, the mass fraction of the $\nspc$ species $\addim{\rho} Y_{\alpha}$ and the total energy $\addim{\rho} \addim{e}_t$. Each species behaves as a thermally perfect gas with its thermodynamic properties determined from the JANAF databases~\cite{sta1971}. The viscosity $\addim{\mu}$ and thermal conductivity $\addim{\lambda}$ depend on the temperature of the mixture as well as its composition. The mixture diffusion coefficients $\addim{D}_{\alpha}$ depend on the temperature and pressure of the mixture but the Dufour and Soret effects are not taken into account. The mass production terms $\addim{\dot{\omega}}_\alpha$ are derived from a set of chemical reaction equations which are expressed in terms of an Arrhenius temperature dependence form, making possible the use of detailed chemical kinetic mechanisms.

The treatment of the advective terms in the transport equations relies on a solution-adaptive finite-difference method whereby different numerical schemes are applied for shocks and broadband turbulence.
%
Narrow regions around shock waves are treated with a nonlinear upwinding seventh-order accurate weighted essentially non-oscillatory (WENO-Z) scheme of \citet{don2013accuracy} with Roe flux splitting, whereas the underlying seventh-order upwind discretization is used elsewhere by disabling the nonlinear weights.
%
At each time step, shocks are detected based on Ducros \cite{ducros1999large} shock sensor which is set to one if $\partial_i u_i>0.7\sqrt{\pars{\partial_i u_i}^2+\Omega^2}$, where $\Omega^2$ is a low-pass-filtered vorticity magnitude.
%
The viscous and molecular diffusion fluxes are discretized using eighth-order centered finite difference formulas.
%
Time integration is carried out by means of a third-order total variation diminishing (TVD) Runge--Kutta algorithm~\cite{gottlieb1998total}.
%
The time step is set such that the acoustic Courant-Friedrichs-Lewy (CFL) number does not exceed $0.5$.
%
The enthalpies and the specific heat capacities of each species are expressed as polynomial functions of temperature using the \texttt{JANAF} tables \cite{stull1971janaf}. %
The above mentioned transport coefficients, \textit{i.e.}, $\kappa$, $\mu$, $\widetilde{\mathcal{D}}_{\alpha,\beta}$ and $\tilde{\chi}_{\beta}$, which are functions of the temperature and the mixture, are evaluated using the general purpose \texttt{FORTRAN} library \texttt{EGLIB} \cite{ern_eglib_2004}.
%
The supersonic streams of hydrogen/air consists of nine species ($\mathrm{H_2}$, $\mathrm{O_2}$, $\mathrm{H}$, $\mathrm{O}$, $\mathrm{OH}$, $\mathrm{HO_2}$, $\mathrm{H_2O_2}$, $\mathrm{H_2O}$, $\mathrm{N_2}$).
%
To speed up the simulations of the inert cases, the intermediate species are neglected and the mass fraction of $\mathrm{N_2}$ is slightly modified to guarantee mass conservation.
%
A detailed verification of the solver may be found in \cite{boukharfane2018contribution}.

%=============================================================
\section{Generalized polynomial chaos}
%=============================================================
The main features of the generalized polynomial chaos approach are briefly recalled here; for more details we refer to \citet{ghanem2003stochastic} and \citet{le2010spectral}.
%
In the last years, this stochastic approach has been applied to turbulent flow analysis with satisfying results \cite{lucor2007sensitivity}. 
%
Define a {\it probability space} ($\Omega$,$\mathcal{A}$,$\mathcal{P}$) where $\Omega$ is the event space, $\mathcal{A} \subset 2^{\Omega}$ its $\sigma$-algebra and $\mathcal{P}$ its probability measure.
%
Being $\omega$ an element of the event space, we define a random field $X(\omega)$ such that it maps the probability space into a function space $V$, $X:\Omega \rightarrow V$.
%
In the following we will consider second-order random fields, \textit{i.e.}, those satisfying the relation:
\begin{equation}
 {\bf E}(X,X) < + \infty,
\end{equation} 
where ${\bf E}$ denotes the expectation of a random variable.
%
In this context, gPC is a tool allowing second-order random fields to be represented through a set of random variables ${\bf \xi}(\omega)$.
%
An approximation of the random field $X(\omega)$ is then recovered through its Galerkin projection onto a polynomial orthogonal basis taking the following form:
%
\begin{equation}
X(\omega)=a_0B_0 + \sum_{i_1=1}^{\infty}a_{i_1}B_1({ \xi_{i_1}})+ \sum_{i_1=1}^{\infty} \sum_{i_2=1}^{i_1}a_{i_1 i_2}B_2({ \xi_{i_1}, \xi_{i_2}}) + ...,
\label{EldredEq}
\end{equation}
%
where $\xi = (\xi_1, ..., \xi_N)^T$ is a N-dimensional random vector and $B_i$ is a polynomial of order $i$ depending on the $\sigma$ algebra of $\xi$.
%
This expression can be easily reformulated using a term-based indexing instead of a order-based indexing.
%
Let $\Phi_k({\bf \xi}(\omega))$ be a single polynomial, the pseudospectral approximation \eqref{EldredEq} can be written as follows:
%
\begin{equation}
X(\omega)=\sum_{k=0}^{\infty}a_k\Phi_k({\bf \xi}(\omega)),
\label{LucorEq}
\end{equation}
%
in which there is a one-to-one correspondence between $a_{i_1 \, i_2 \, \cdots \, I_n}$ and $a_k$ and between $B_n({ \xi_{i_1}, \, \xi_{i_2}, \, \cdots \,, \, \xi_{i_n}})$ and $\Phi_k({\bf \xi})$
The polynomial expansion is truncated to a finite limit and the orthogonality of the polynomials is set through the relation
%
\begin{equation}
<\Phi_i \Phi_j>=<\Phi_i^2> \delta_{ij},
\end{equation}
%
where $<\cdot,\cdot>$ denotes an ensemble average.
%
This inner product is defined over the measure $W(\xi)$ of the random variables as follows:
%
\begin{equation}
<f(\xi)g(\xi)>= \int_{\omega \in \Omega} f(\xi)g(\xi)dP(\omega)= \int f(\xi)g(\xi) W(\xi) d \xi.
\end{equation}
%
Thanks to the orthogonality of the polynomial basis, each coefficient of the Galerkin projection \eqref{LucorEq} can be recovered through the following definition:
%
\begin{equation}
a_k = \frac{<X,\Phi_k>}{<\Phi_{k}^2>}= \frac{1}{<\Phi_{k}^2>}\int_{\omega \in \Omega} X \Phi_k \rho({\bf \xi}) d({\bf \xi}),
\end{equation}
%
where each inner product involves a multidimensional integral over the support range of the weighting function.
%
The integrals can be computed through different mathematical methods: considering the number of random variables investigated, the coefficients $a_k$ have been computed through Gaussian quadrature in the present work.

The polynomial family to be used must be a priori specified. The choice of the polynomials affects the speed of the convergence of the series: a unsuitable polynomial family may lead to the need of a large number of degrees of freedom to obtain a given level of accuracy (\textit{i.e.} a higher order of the polynomials), while a suitable polynomials family is able to interpolate both the input and the random variables by means of a few degrees of freedom.
%
In the case of the input, when dealing with Gaussian quadrature, an optimal family has a weight coefficient similar to the function $W$.
%
The probability density function $\texttt{PDF}$ of the random variables has been considered as \textit{uniform} leading to the choice of the Legendre polynomial family: this is a well suited choice since the inner product weighting function is directly proportional with a factor $0.5$ to the set probability density function.
%
The polynomial expansion has been limited to the third order since the contribution of fourth and higher order polynomials is negligible.
%
This leads to the use of a 20 polynomial basis to generate the error cost function over the uncertainty space. 
%
The gPC application is herein used in its non-intrusive approach, \textit{i.e.}, the variables, and more precisely the error cost functions are directly projected over the orthogonal basis spanning the random space, without any modification of the deterministic solver. 
%
The number of points to discretize each random variable space is chosen in order to recover converged integrals when computing the polynomial coefficients.
%
The polynomial expansion being truncated to the third order, $4$ points for each random variable are sufficient to compute the coefficients $a_k$.
%
The accuracy of the method has been investigated by checking that the contribution of polynomials of order higher than three remains very low for all the considered quantities. 


%=============================================================
\bibliography{main}
%=============================================================
\end{document}